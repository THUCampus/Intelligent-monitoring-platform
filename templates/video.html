{% extends 'base.html' %}

{% block header %}
    <h1>{% block title %}监控界面{% endblock %}</h1>
    {% if g.user and g.user['is_manager'] %}
        <a class="action" href="{{url_for('auth.manage')}}">管理员界面</a>
        <a class="action" href="{{url_for('auth.register')}}">注册新用户</a>
        <a class="action" href="{{url_for('criminal.register')}}">逃犯信息录入</a>
    {% endif%}
    <a class="action" href="{{url_for('auth.update_password')}}">修改密码</a>
    <a class="action" href="{{url_for('history_records.manage')}}">历史警示记录</a>
{% endblock %}

{% block content %}
    <form method="post">
        <label for="ip">IP</label>
        <input name="ip" id="ip" required>
        <input type="submit" value="提交">
    </form>

    <img src="{{ url_for('video.video_feed') }}" width="900px">

    <h2>最新警示记录</h2>
    {% for record in records %}
        <article class="post">
            <header>
                <div>
                    <h1>{{record['criminal_name']}}({{ record['criminal_id'] }})
                        在时刻{{ record['time'] }}出现在了摄像头{{ record['camera_id'] }}</h1>
                    <div class="about">
                        {% if record['criminal_important'] %}
                            A级逃犯
                        {% endif %}
                    </div>
                </div>
                <form action="{{ url_for('history_records.delete', id=record['id']) }}" method="post">
                    <input class="danger" type="submit" value="删除" onclick="return confirm('你确定要删除这条记录吗?');">
                </form>
            </header>
        </article>
    {% endfor %}
{% endblock %}